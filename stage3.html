<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>The Spice | Snack Attack</title>
    <style>
        :root { --neon-cyan: #00FFFF; --neon-pink: #FF00FF; --neon-green: #39FF14; }
        
        body {
            margin: 0; padding: 0;
            background: url('cyber-kitchen-bg.PNG') no-repeat center center fixed;
            background-size: cover;
            height: 100vh; overflow: hidden; background-color: #000;
            font-family: 'Courier New', monospace;
        }

        body::before {
            content: ""; position: fixed; inset: 0;
            background: rgba(0, 0, 0, 0.6); z-index: 0;
        }

        #ui { 
            position: absolute; 
            top: 85px; /* Clear Dynamic Island */
            left: 20px; 
            color: var(--neon-cyan); 
            z-index: 100; 
            text-shadow: 2px 2px #000;
        }
        
        /* Grounded Bowl using the 'vh' fix */
        #target-bowl {
            position: absolute;
            top: 75vh; 
            left: 50%;
            transform: translate(-50%, -50%);
            width: 320px; 
            z-index: 10;
        }

        /* Oscillating Garlic */
        #garlic-container {
            position: absolute;
            top: 150px;
            left: 0;
            width: 100%;
            height: 100px;
            z-index: 20;
        }

        #garlic-claw {
            position: absolute;
            width: 80px;
            left: 50%;
            transform: translateX(-50%);
            animation: moveHorizontal 2.5s ease-in-out infinite alternate;
        }

        @keyframes moveHorizontal {
            from { left: 15%; }
            to { left: 85%; }
        }

        /* Drop Animation */
        .dropping {
            animation: none !important; /* Stop horizontal move */
            transition: top 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94), transform 0.6s;
            top: 70vh !important;
            transform: translateX(-50%) scale(0.6) !important;
            opacity: 0;
        }

        #next-btn {
            display: none; position: absolute; top: 50%; left: 50%;
            transform: translate(-50%, -50%); padding: 20px 40px;
            background: var(--neon-green); border: none; color: black;
            font-weight: bold; border-radius: 50px; z-index: 500;
            box-shadow: 0 0 20px var(--neon-green);
        }
    </style>
</head>
<body onclick="dropGarlic()">

<div id="ui">MISSION: CALIBRATE FLAVOR<br>Garlic Claws: <span id="score">0</span>/3</div>

<div id="garlic-container">
    <img src="garlic.png" id="garlic-claw">
</div>

<img src="bowl-with-soup.png" id="target-bowl">

<button id="next-btn" onclick="window.location.href='win.html'">SERVE MEAL</button>

<script>
    let caught = 0;
    const claw = document.getElementById('garlic-claw');
    const bowl = document.getElementById('target-bowl');
    const scoreText = document.getElementById('score');
    const nextBtn = document.getElementById('next-btn');

    function dropGarlic() {
        if (claw.classList.contains('dropping')) return;

        // Capture current left position before dropping
        const currentLeft = window.getComputedStyle(claw).left;
        claw.style.left = currentLeft;
        claw.classList.add('dropping');
        
        const clawRect = claw.getBoundingClientRect();
        const bowlRect = bowl.getBoundingClientRect();

        // Check hit after the drop duration
        setTimeout(() => {
            const finalLeft = clawRect.left + (clawRect.width / 2);
            
            if (finalLeft > bowlRect.left && finalLeft < bowlRect.right) {
                caught++;
                scoreText.innerText = caught;
                if (navigator.vibrate) navigator.vibrate([50, 30, 50]);
            }

            if (caught >= 3) {
                nextBtn.style.display = 'block';
                claw.style.display = 'none';
            } else {
                // Reset for next claw
                claw.classList.remove('dropping');
                claw.style.top = "0px";
                claw.style.opacity = "1";
            }
        }, 600);
    }
</script>
</body>
</html>
